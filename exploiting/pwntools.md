# pwntools

- Repo: https://github.com/Gallopsled/pwntools
- Docs: https://docs.pwntools.com/


## Installation

```
pip install pwntools
```

## De Bruijn patterns

We can generate a De Bruijn sequence with `pwn.cyclic`:
```
$ python3 -c "import pwn; print(pwn.cyclic(40, n=4).decode())"
aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaa
```

And then search for an string or hexadecimal representation of chars inside the
sequence with `pwn.cyclic_find`:
```
$ python3 -c "import pwn; print(pwn.cyclic_find('aaac',n=4))"
5
```

```
$ python3 -c "import pwn; print(pwn.cyclic_find(0x63616161,n=4))"
5
```

## List architectures

```python
from pwn import *
sorted(list(context.architectures))
```

Result:
```
['aarch64', 'alpha', 'amd64', 'arm', 'avr', 'cris', 'i386', 'ia64', 'm68k',
'mips', 'mips64', 'msp430', 'none', 'powerpc', 'powerpc64', 'riscv32',
'riscv64', 's390', 'sparc', 'sparc64', 'thumb', 'vax']
```

## List OSes

```python
from pwn import *
sorted(list(context.oses))
```

Result:
```
['android', 'baremetal', 'cgc', 'darwin', 'freebsd', 'linux', 'windows']
```


## pwn Template

```python
#!/usr/bin/env python3
import argparse
from pwn import *

def parse_args():
    parser = argparse.ArgumentParser()
    parser.add_argument("host")
    parser.add_argument("port", type=int)
    return parser.parse_args()

def main():
    args = parse_args()

    # archs: i386, amd64, arm, aarch64
    context(arch="amd64", os="linux")

    # conn = process("/bin/sh")
    conn = remote(args.host, args.port)
    print(conn.recvline())

    conn.send(b"A\n")

    address = int(conn.recvuntil(b":")[:-1], base=0)
    print("0x{:x}".format(address))

    payload_len = 164
    shc = b""
    padding = b"A" * (payload_len - len(shc))
    ret_addr = p32(address)

    conn.send(shc + padding + ret_addr + b"\n")

    print(conn.recvuntil(b":\n").decode())

    conn.interactive()

if __name__ == "__main__":
    exit(main())
```
